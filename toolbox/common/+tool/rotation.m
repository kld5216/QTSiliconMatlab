function R = rotation(n,th)
R = zeros(3,3);
C = cos(th*pi/180);
S = sin(th*pi/180);
R(1,1) = n(1)*n(1)*(1-C)+C;
R(1,2) = n(1)*n(2)*(1-C)+n(3)*S;
R(1,3) = n(1)*n(3)*(1-C)-n(2)*S;
R(2,1) = n(1)*n(2)*(1-C)-n(3)*S;
R(2,2) = n(2)*n(2)*(1-C)+C;
R(2,3) = n(2)*n(3)*(1-C)+n(1)*S;
R(3,1) = n(1)*n(3)*(1-C)+n(2)*S;
R(3,2) = n(2)*n(3)*(1-C)-n(1)*S;
R(3,3) = n(3)*n(3)*(1-C)+C;
end